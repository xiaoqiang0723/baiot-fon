(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bd593cfe"],{1151:function(a,t,e){},"640c":function(a,t,e){"use strict";e.r(t);var s=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"equip-manage-contain"},[e("article",{staticClass:"equip-manage-statistics"},[e("div",{staticClass:"statistics-item"},[e("p",{staticClass:"item-title"},[a._v("设备总数")]),e("p",{staticClass:"item-count"},[a._v(a._s(a.statisticsData.totalCount))])]),e("div",{staticClass:"statistics-item"},[e("p",{staticClass:"item-title"},[a._v("在线数")]),e("p",{staticClass:"item-count"},[a._v(a._s(a.statisticsData.online))])]),e("div",{staticClass:"statistics-item"},[e("p",{staticClass:"item-title"},[a._v("当天告警次数")]),e("p",{staticClass:"item-count"},[a._v(a._s(a.statisticsData.alertCount))])]),e("div",{staticClass:"statistics-item"},[e("p",{staticClass:"item-title"},[a._v("累计告警次数")]),e("p",{staticClass:"item-count"},[a._v(a._s(a.statisticsData.totalAlertCount))])]),e("div",{staticClass:"statistics-item"},[e("p",{staticClass:"item-title"},[a._v("告警下发次数")]),e("p",{staticClass:"item-count"},[a._v(a._s(a.statisticsData.commandCount))])])]),e("article",{staticClass:"equip-manage-search clearfix"},[e("div",{staticClass:"equip-manage-search-inner aiot-search-contain clearfix"},[e("div",{staticClass:"search-module clearfix"},[e("span",{staticClass:"search-module-name"},[a._v("地区")]),e("span",{staticClass:"search-module-value"},[e("el-cascader",{attrs:{placeholder:"请选择地区",options:a.locationData,props:{value:"name",label:"name"},filterable:""},model:{value:a.location,callback:function(t){a.location=t},expression:"location"}})],1)]),e("div",{staticClass:"search-module clearfix"},[e("span",{staticClass:"search-module-name"},[a._v("单位")]),e("span",{staticClass:"search-module-value"},[e("el-input",{attrs:{placeholder:"请输入单位",clearable:""},model:{value:a.seachData.agency,callback:function(t){a.$set(a.seachData,"agency",t)},expression:"seachData.agency"}})],1)]),e("div",{staticClass:"search-module clearfix"},[e("span",{staticClass:"search-module-name"},[a._v("道路")]),e("span",{staticClass:"search-module-value"},[e("el-input",{attrs:{placeholder:"请输入道路",clearable:""},model:{value:a.seachData.road,callback:function(t){a.$set(a.seachData,"road",t)},expression:"seachData.road"}})],1)]),e("div",{staticClass:"search-module clearfix"},[e("span",{staticClass:"search-module-name"},[a._v("设备编号")]),e("span",{staticClass:"search-module-value"},[e("el-input",{attrs:{placeholder:"请输入设备编号",clearable:""},model:{value:a.seachData.imei,callback:function(t){a.$set(a.seachData,"imei",t)},expression:"seachData.imei"}})],1)]),e("div",{staticClass:"search-module clearfix"},[e("span",{staticClass:"search-module-name"},[a._v("设备状态")]),e("span",{staticClass:"search-module-value"},[e("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:a.seachData.state,callback:function(t){a.$set(a.seachData,"state",t)},expression:"seachData.state"}},[e("el-option",{attrs:{label:"告警",value:1}}),e("el-option",{attrs:{label:"下发",value:2}})],1)],1)]),e("div",{staticClass:"search-module search-module2 clearfix"},[e("span",{staticClass:"search-module-name"},[a._v("告警时间")]),e("span",{staticClass:"search-module-value"},[e("el-date-picker",{attrs:{clearable:"",type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},model:{value:a.seachData.alertTime,callback:function(t){a.$set(a.seachData,"alertTime",t)},expression:"seachData.alertTime"}})],1)]),e("div",{staticClass:"search-button",on:{click:a.searchData}})])]),e("article",{ref:"listTable",staticClass:"equip-manage-list table-wrapper"},[e("AiotList",{attrs:{totalNum:a.totalNum,isFull:!0,sizeType:1},on:{changePage:a.changePage}},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:a.tableData,"header-row-class-name":"aiot-table-list-header","row-class-name":"aiot-table-list-row","tooltip-effect":"light",height:"100%"}},[a._l(a.columns,(function(t,s){return["isIssue"===t.key?e("el-table-column",{key:t.key+s,attrs:{prop:t.key,label:t.label,"min-width":t.width},scopedSlots:a._u([{key:"default",fn:function(t){return[t.row.isIssue?e("el-tooltip",{attrs:{content:"查看下发信息",placement:"top"}},[e("span",{staticClass:"issue",on:{click:function(e){return a.toDetail(t.row)}}},[a._v("已下发")])]):e("span",[a._v("未下发")])]}}],null,!0)}):e("el-table-column",{key:t.key+s,attrs:{prop:t.key,label:t.label,width:t.width,formatter:a.formatterColumn,"show-overflow-tooltip":""}})]}))],2)],1)],1),e("el-dialog",{attrs:{visible:a.equipIssueShow,width:"800px",title:"下发编组",center:"","custom-class":"aiot-modal","append-to-body":!0},on:{"update:visible":function(t){a.equipIssueShow=t}}},[a.equipIssueShow?e("EquipIssue",{attrs:{eventId:a.equipIssueData.eventId,imei:a.equipIssueData.imei}}):a._e()],1)],1)},i=[],l=e("c7eb"),c=e("1da1"),n=e("1086"),o=e("82cb"),r=e("1065"),u=e("4bff"),d=e("0933"),h=e("8691"),m={components:{AiotList:o["a"],EquipIssue:h["a"]},mixins:[d["a"]],data:function(){return{formatVal:n["d"],locationData:r["a"],totalNum:0,pageSize:10,pageNum:1,tableData:[],columns:[{label:"设备编号",key:"imei"},{label:"状态",key:"eventState",width:80},{label:"所属单位",key:"agency"},{label:"路段",key:"road"},{label:"告警时间",key:"eventTime"},{label:"是否下发",key:"isIssue",width:100},{label:"下发编组",key:"consumerGroupCode"},{label:"下发路段",key:"consumerRoad"},{label:"是否解除",key:"isEnd"}],statisticsData:{totalCount:"",online:"",alertCount:"",totalAlertCount:"",commandCount:""},location:"",seachData:{province:"",city:"",agency:"",road:"",imei:"",state:"",alertTime:[]},equipIssueData:{},equipIssueShow:!1}},computed:{},watch:{location:function(){this.seachData.province=this.location[this.location.length-2]||"",this.seachData.city=this.location[this.location.length-1]||""}},methods:{formatterColumn:function(a,t){var e=t.property,s="";switch(e){case"eventState":s=this.eventStatusMap[a[e]];break;case"isIssue":s=a[e]?"已下发":"未下发";break;case"isEnd":s=a[e]?"已解除":"未解除";break;default:s=a[e];break}return Object(n["d"])(s)},changePage:function(a){switch(a.type){case"number":this.pageNum=a.value;break;case"size":this.pageSize=a.value;break;default:break}this.searchData()},searchData:function(){this.queryEventList(),this.getOverview()},queryEventList:function(){var a=this;return Object(c["a"])(Object(l["a"])().mark((function t(){var e,s,i,c,n;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return c={agency:a.seachData.agency,province:a.seachData.province,city:a.seachData.city,road:a.seachData.road,imei:a.seachData.imei,endTime:(null===(e=a.seachData.alertTime)||void 0===e?void 0:e.length)>0?a.seachData.alertTime[0]:"",startTime:(null===(s=a.seachData.alertTime)||void 0===s?void 0:s.length)>0?a.seachData.alertTime[1]:"",state:a.seachData.state,pageNum:a.pageNum,pageSize:a.pageSize},t.next=3,Object(u["l"])(c);case 3:n=t.sent,console.log("列表:",n),a.totalNum=(null===(i=n.meta)||void 0===i?void 0:i.count)||0,a.tableData=n.data||[];case 7:case"end":return t.stop()}}),t)})))()},getOverview:function(){var a=this;return Object(c["a"])(Object(l["a"])().mark((function t(){var e;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["j"])({agency:a.seachData.agency,province:a.seachData.province,city:a.seachData.city,road:a.seachData.road});case 2:e=t.sent,console.log("总览：",e),a.statisticsData={totalCount:(null===e||void 0===e?void 0:e.devCount)||0,online:(null===e||void 0===e?void 0:e.onlineCount)||0,alertCount:(null===e||void 0===e?void 0:e.curEventCount)||0,totalAlertCount:(null===e||void 0===e?void 0:e.eventCount)||0,commandCount:(null===e||void 0===e?void 0:e.eventIssueCount)||0};case 5:case"end":return t.stop()}}),t)})))()},toDetail:function(a){console.log(a),this.equipIssueData=a,this.equipIssueShow=!0}},mounted:function(){this.searchData()}},p=m,v=(e("ec38"),e("c1bd"),e("2877")),b=Object(v["a"])(p,s,i,!1,null,"3dc23fd2",null);t["default"]=b.exports},"7f93":function(a,t,e){},c1bd:function(a,t,e){"use strict";e("7f93")},ec38:function(a,t,e){"use strict";e("1151")}}]);
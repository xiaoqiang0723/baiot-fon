(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d22dbf3"],{"046b":function(t,e,a){},1086:function(t,e,a){"use strict";a.d(e,"d",(function(){return r})),a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return s}));a("99af");var r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t||0===t?t+e:"-"},n=function(t,e){return parseInt(t,10)&&parseInt(e,10)},i=function(t,e){return n(t,e)?"".concat(t,"-").concat(e):"-"},s=function(t){return t?"K".concat(parseInt(t,10),"+").concat(parseInt(t%1*1e3,10)):"-"}},1312:function(t,e,a){"use strict";a("c13f")},2561:function(t,e,a){"use strict";a("6d4a")},"303f":function(t,e,a){"use strict";var r=a("2b0e"),n=new r["default"];e["a"]=n},3511:function(t,e){var a=TypeError,r=9007199254740991;t.exports=function(t){if(t>r)throw a("Maximum allowed index exceeded");return t}},"39ea":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("d3b7"),a("159b");var r=a("4360"),n={OCCUPY_MANAGE_OPERATE:2015,OCCUPY_MANAGE_LIST:2026,OCCUPY_EQUIP_LIST:2027,OCCUPY_EQUIP_OPERATE:2028,GUARDRAIL_WARNING_OPERATE:2024,GUARDRAIL_WARNING_LIST:2029,GUARDRAIL_EQUIP_LIST:2030,GUARDRAIL_EQUIP_OPERATE:2031,GUARDRAIL_EQUIP_ADD:2019,GUARDRAIL_STOCK_ADD:2040,GUARDRAIL_STOCK_LIST:2041,GUARDRAIL_STOCK_BIND:2042,GUARDRAIL_STOCK_DELETE:2043,GUARDRAIL_EVENTS_LIST:2034,GUARDRAIL_ONE_STOCK_ADD:2046,GUARDRAIL_ONE_STOCK_LIST:2047,GUARDRAIL_ONE_STOCK_BIND:2048,GUARDRAIL_ONE_STOCK_DELETE:2049,USER_SEARCH_LIST:2051},i=function(t){var e=r["a"].state.permission.authList,a=!1;return e.forEach((function(e){e.menuId===n[t]&&(a=!0)})),a}},"408a":function(t,e,a){var r=a("e330");t.exports=r(1..valueOf)},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,a){var r=a("e330"),n=a("1d80"),i=a("577e"),s=a("5899"),o=r("".replace),l="["+s+"]",c=RegExp("^"+l+l+"*"),u=RegExp(l+l+"*$"),f=function(t){return function(e){var a=i(n(e));return 1&t&&(a=o(a,c,"")),2&t&&(a=o(a,u,"")),a}};t.exports={start:f(1),end:f(2),trim:f(3)}},"66a9":function(t,e,a){"use strict";a("046b")},"6d4a":function(t,e,a){},"6d4b":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:t.containId,staticClass:"occupy-manage-contain"},[a("article",{ref:"listTable",staticClass:"occupy-manage-list table-wrapper"},[a("AiotList",{attrs:{totalNum:t.totalNum,isFull:!1},on:{showList:t.showList,changePage:t.changePage}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"header-row-class-name":"aiot-table-list-header","row-class-name":"aiot-table-list-row","tooltip-effect":"light",height:"100%"}},[a("el-table-column",{attrs:{label:"",width:"40"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("span",{class:["occupy-manage-status",{active:0===t.row.eventState||-1===t.row.eventState}]})]}}])}),t._l(t.columns,(function(e,r){return["charge"===e.key?a("el-table-column",{key:e.key+r,attrs:{prop:e.key,label:e.label,width:e.width},scopedSlots:t._u([{key:"default",fn:function(t){return[a("Battery",{attrs:{batteryLay:"vertical",batteryNum:t.row.charge}})]}}],null,!0)}):a("el-table-column",{key:e.key+r,attrs:{prop:e.key,label:e.label,width:e.width,align:"center","show-overflow-tooltip":!0,formatter:t.formatterColumn}})]})),t.isOpearte?a("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"occupy-manage-list-operate operate2",on:{click:function(a){return a.stopPropagation(),t.showDetailDialog(e.row)}}})]}}],null,!1,4246268629)}):t._e()],2)],1)],1),a("el-dialog",{attrs:{visible:t.occupyDetailShow,width:"1400px",title:"设备预警详情",center:"","custom-class":"aiot-modal","append-to-body":!0},on:{"update:visible":function(e){t.occupyDetailShow=e}}},[t.occupyDetailShow?a("OccupyDetail",{attrs:{deviceId:t.activityDeviceId},on:{showDetailDialog:t.showListDialog,showListDialog:t.showListDialog}}):t._e()],1),a("el-dialog",{attrs:{visible:t.occupyListShow,width:"600px",title:"设备操作",center:"","custom-class":"aiot-modal","append-to-body":!0},on:{"update:visible":function(e){t.occupyListShow=e}}},[t.occupyListShow?a("EquipOperate",{attrs:{equipList:t.activeOccupyList}}):t._e()],1)],1)},n=[],i=a("c7eb"),s=a("1da1"),o=(a("d3b7"),a("159b"),a("d81d"),a("99af"),a("98c8")),l=a("82cb"),c=a("a072"),u=a.n(c),f=a("7f35"),h=a.n(f),p=a("8956"),d=a.n(p),g=a("fa12"),b=a("39ea"),m=a("4bff"),y=a("303f"),w=a("1086"),L=a("2b09"),v=a("0bee"),k=a("0933"),_={name:"occupyManage",mixins:[k["a"]],components:{Battery:o["a"],AiotList:l["a"],OccupyDetail:L["a"],EquipOperate:v["a"]},data:function(){return{isOpearte:Object(b["a"])("GUARDRAIL_WARNING_OPERATE"),containId:g["a"].createGuid(),tableData:[],columns:[{label:"设备编号",key:"imei"},{label:"组网编号",key:"groupCode"},{label:"占道路段",key:"road"},{label:"设备电量",key:"charge",width:100},{label:"设备状态",key:"onlineState",width:150},{label:"安装时间",key:"installTime"},{label:"报警时间",key:"lastAlertTime"}],totalNum:30,pageSize:6,pageNum:1,occupyDetailShow:!1,occupyListShow:!1,activeOccupyDetail:{},activityDeviceId:"",activeOccupyList:[],formatVal:w["d"],cluster:null,allData:[],points:[]}},mounted:function(){var t=this;this.$nextTick((function(){document.getElementsByClassName("aiot-map-outer-contain")[0].style.height="40%"})),setTimeout((function(){t.getData()}),1e3),y["a"].$on("refreshData",this.getData)},computed:{warningPush:function(){return this.$store.state.globals.socketData}},watch:{warningPush:function(){var t=this;if("gr"===this.warningPush.dev_type){for(var e=!1,a=0;a<this.allData.length;a+=1)if(this.allData[a].imei===this.warningPush.imei){e=!0,this.allData[a].eventState=this.warningPush.event_state;break}e&&(this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){t.showMarker(t.allData),t.getData(!0)}),1e3))}}},methods:{showList:function(t){t?(this.$refs.listTable.style.height="60%",setTimeout((function(){document.getElementsByClassName("aiot-map-outer-contain")[0].style.height="40%"}),300)):(this.$refs.listTable.style.height="0",setTimeout((function(){document.getElementsByClassName("aiot-map-outer-contain")[0].style.height="100%"}),0))},showListDialog:function(t){this.activeOccupyList=t.children||[t],this.occupyListShow=!0},showDetailDialog:function(t){this.activityDeviceId=t.id,this.occupyDetailShow=!0},changePage:function(t){switch(t.type){case"number":this.pageNum=t.value;break;case"size":this.pageSize=t.value;break;default:break}this.getData()},getMap:function(){return Window.guardrailMap},rowClick:function(t){var e=this;return Object(s["a"])(Object(i["a"])().mark((function a(){return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:Object(w["a"])(t.lon,t.lat)?e.getMap().setZoomAndCenter(18,new AMap.LngLat(t.lon,t.lat)):e.$message("无经纬度信息");case 1:case"end":return a.stop()}}),a)})))()},getMarkerIcon:function(t){switch(t){case 0:return u.a;case 1:return h.a;case 2:return d.a;case 3:return h.a;case 4:return d.a;default:return u.a}},getData:function(t){var e=this;return Object(s["a"])(Object(i["a"])().mark((function a(){var r,n,s;return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(m["m"])({page_num:e.pageNum,page_size:e.pageSize});case 2:r=a.sent,n=r.data,s=r.meta.count,e.tableData=n,e.totalNum=s,t||setTimeout((function(){e.getAllData()}),1e3);case 7:case"end":return a.stop()}}),a)})))()},getAllData:function(){var t=this;return Object(s["a"])(Object(i["a"])().mark((function e(){var a,r;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(m["m"])({page_num:t.pageNum,page_size:-1});case 2:a=e.sent,r=a.data,t.allData=r,t.showMarker(r);case 6:case"end":return e.stop()}}),e)})))()},showMarker:function(t){var e=this;this.getMap().clearMap(),this.cluster=null;var a=[];t.forEach((function(t){Object(w["a"])(t.lon,t.lat)&&a.push({lnglat:[t.lon,t.lat],extData:t})})),this.points=a,this.cluster=new AMap.MarkerClusterer(this.getMap(),this.points,{renderClusterMarker:this.renderClusterMarker,renderMarker:this.renderMarker,gridSize:20}),this.getMap().setFitView(),this.cluster.on("click",(function(t){t.clusterData.length>1?e.map.setZoomAndCenter(t.marker.getPosition()):e.showDetailDialog(t.clusterData[0].extData)})),this.getMap().add(this.cluster)},renderMarker:function(t){var e=t.data[0].extData,a=new AMap.Pixel(-13,-40);t.marker.setIcon(new AMap.Icon({size:new AMap.Size(26,41),image:this.getMarkerIcon(e.eventState),imageSize:new AMap.Size(26,40),imageOffset:new AMap.Pixel(0,0)})),t.marker.setOffset(a)},renderClusterMarker:function(t){var e=document.createElement("div");e.style.background="url(".concat(u.a,") no-repeat bottom "),e.style.width="26px",e.style.height="60px",e.style.lineHeight="20px",e.style.color="#fff",e.style.fontSize="14px",e.style.textAlign="center";var a=document.createElement("div");a.style.display="inline-block",a.style.padding="1px 5px",a.innerHTML=t.count,a.style.lineHeight="16px",a.style.color="#fff",a.style.fontSize="14px",a.style.textAlign="center",a.style.borderRadius="16px",a.style.backgroundColor="#F75692",e.appendChild(a),t.marker.setOffset(new AMap.Pixel(-13,-60)),t.marker.setContent(e)},getDetail:function(t){return Object(s["a"])(Object(i["a"])().mark((function e(){var a;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(m["g"])(t);case 2:a=e.sent,console.log(a);case 4:case"end":return e.stop()}}),e)})))()},formatterColumn:function(t,e){var a=e.property,r="";switch(a){case"onlineState":r=this.onlineStatusMap[t[a]];break;case"road":r="".concat(t.roadCode+t.road," K").concat(t.stake);break;default:r=t[a];break}return Object(w["d"])(r)}},beforeDestroy:function(){this.markers&&this.markers.length>1&&this.markers.forEach((function(t){return t.setMap(null)})),this.markers=[],this.getMap().clearMap()}},S=_,D=(a("66a9"),a("1312"),a("2877")),A=Object(D["a"])(S,r,n,!1,null,"542b6dcc",null);e["default"]=A.exports},"82cb":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"aiot-list-contain"},[t.isFull?t._e():a("div",{class:["aiot-list-control",{active:!t.isShowList}],on:{click:t.toggleList}}),a("div",{class:["aiot-list-content",{full:t.isFull}]},[a("div",{staticClass:"aiot-list-table"},[a("div",{staticClass:"aiot-list-table-header-mask"}),t._t("default")],2),t.isShowList?a("div",{staticClass:"aiot-list-pagination"},[a("el-pagination",{attrs:{background:"","current-page":t.pageNumber,"page-sizes":1===t.sizeType?[10,20,30]:[6,12],"page-size":6,layout:"total, sizes, prev, pager, next, jumper",total:t.totalNum},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()])])},n=[],i=(a("a9e3"),{props:{totalNum:{type:Number,default:0},isFull:{type:Boolean,default:!1},sizeType:{type:Number,default:0}},data:function(){return{isShowList:!0,pageSize:6,pageNumber:1}},methods:{toggleList:function(){this.isShowList=!this.isShowList,this.$emit("showList",this.isShowList)},handleSizeChange:function(t){this.pageSize=t,this.$emit("changePage",{type:"size",value:this.pageSize})},handleCurrentChange:function(t){this.pageNumber=t,this.$emit("changePage",{type:"number",value:this.pageNumber})}}}),s=i,o=(a("bfd4"),a("2877")),l=Object(o["a"])(s,r,n,!1,null,"7fe7058a",null);e["a"]=l.exports},"98c8":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:["battery-contain",{vertical:"vertical"===t.batteryLay,horizontal:"horizontal"===t.batteryLay}]},[t.batteryNum<=20?a("div",{staticClass:"battery-warning"}):t._e(),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"电池电量: "+t.batteryNum+"%",placement:"top"}},[a("svg",{staticClass:"battery-svg-contain"},[a("defs",[a("linearGradient",{attrs:{id:"health",x1:"100%",y1:"0%",x2:"100%",y2:"100%"}},[a("stop",{attrs:{offset:"0%","stop-color":"rgb(214,250,173)"}}),a("stop",{attrs:{offset:"100%","stop-color":"rgb(67,231,207)"}})],1)],1),a("defs",[a("linearGradient",{attrs:{id:"health1",x1:"0%",y1:"100%",x2:"100%",y2:"100%"}},[a("stop",{attrs:{offset:"0%","stop-color":"rgb(214,250,173)"}}),a("stop",{attrs:{offset:"100%","stop-color":"rgb(67,231,207)"}})],1)],1),a("defs",[a("linearGradient",{attrs:{id:"normal",x1:"100%",y1:"0%",x2:"100%",y2:"100%"}},[a("stop",{attrs:{offset:"0%","stop-color":"rgb(94,231,223)"}}),a("stop",{attrs:{offset:"100%","stop-color":"rgb(180,144,202)"}})],1)],1),a("defs",[a("linearGradient",{attrs:{id:"normal1",x1:"0%",y1:"100%",x2:"100%",y2:"100%"}},[a("stop",{attrs:{offset:"0%","stop-color":"rgb(94,231,223)"}}),a("stop",{attrs:{offset:"100%","stop-color":"rgb(180,144,202)"}})],1)],1),a("defs",[a("linearGradient",{attrs:{id:"warning",x1:"100%",y1:"0%",x2:"100%",y2:"100%"}},[a("stop",{attrs:{offset:"0%","stop-color":"rgb(255,144,146)"}}),a("stop",{attrs:{offset:"100%","stop-color":"rgb(254,108,156)"}})],1)],1),a("defs",[a("linearGradient",{attrs:{id:"warning1",x1:"0%",y1:"100%",x2:"100%",y2:"100%"}},[a("stop",{attrs:{offset:"0%","stop-color":"rgb(255,144,146)"}}),a("stop",{attrs:{offset:"100%","stop-color":"rgb(254,108,156)"}})],1)],1),"horizontal"===t.batteryLay?a("g",["health"===t.lineStatus?a("path",{attrs:{d:"M0,0 L24,0 L24,3 L27,3 L27,10 L24,10 L24,15 L0,15 Z",fill:"#FFF",stroke:"#43E7CF","stroke-whith":"1","stroke-linecap":"round"}}):t._e(),"normal"===t.lineStatus?a("path",{attrs:{d:"M0,0 L24,0 L24,3 L27,3 L27,10 L24,10 L24,15 L0,15 Z",fill:"#FFF",stroke:"#5EE7DF","stroke-whith":"1","stroke-linecap":"round"}}):t._e(),"warning"===t.lineStatus?a("path",{attrs:{d:"M0,0 L24,0 L24,3 L27,3 L27,10 L24,10 L24,15 L0,15 Z",fill:"#FFF",stroke:"#FF9092","stroke-whith":"1","stroke-linecap":"round"}}):t._e(),t._l(t.batteryMax,(function(e,r){return a("line",{key:"batteryline"+r,attrs:{x1:2.01+2.2*r,y1:"2",x2:2+2.2*r,y2:"13",stroke:"url(#"+t.lineStatus+")","stroke-width":"1.5"}})}))],2):t._e(),"vertical"===t.batteryLay?a("g",["health"===t.lineStatus?a("path",{attrs:{d:"M4,0 L11,0 L11,3 L15,3 L15,27 L0,27 L0,3 L4,3 Z",fill:"#FFF","stroke-whith":"1",stroke:"#43E7CF","stroke-linecap":"round"}}):t._e(),"normal"===t.lineStatus?a("path",{attrs:{d:"M4,0 L11,0 L11,3 L15,3 L15,27 L0,27 L0,3 L4,3 Z",fill:"#FFF","stroke-whith":"1",stroke:"#43E7CF","stroke-linecap":"round"}}):t._e(),"warning"===t.lineStatus?a("path",{attrs:{d:"M4,0 L11,0 L11,3 L15,3 L15,27 L0,27 L0,3 L4,3 Z",fill:"#FFF","stroke-whith":"1",stroke:"#FF9092","stroke-linecap":"round"}}):t._e(),t._l(t.batteryMax,(function(e,r){return a("line",{key:"batteryline"+r,attrs:{x1:"2",y1:25.61-2.3*r,x2:"13",y2:25.6-2.3*r,stroke:"url(#"+t.lineStatus+"1)","stroke-width":"1.5"}})}))],2):t._e()])])],1)},n=[],i=(a("a9e3"),{props:{batteryLay:{type:String,default:"vertical"},batteryNum:{type:Number}},data:function(){return{lineStatus:"normal",batteryMax:0}},mounted:function(){this.batteryMax=Math.ceil(this.batteryNum/10),this.lineStatus="normal",this.batteryNum>=70&&(this.lineStatus="health"),this.batteryNum<=30&&(this.lineStatus="warning")}}),s=i,o=(a("2561"),a("2877")),l=Object(o["a"])(s,r,n,!1,null,"268757d4",null);e["a"]=l.exports},"99af":function(t,e,a){"use strict";var r=a("23e7"),n=a("d039"),i=a("e8b5"),s=a("861d"),o=a("7b0b"),l=a("07fa"),c=a("3511"),u=a("8418"),f=a("65f0"),h=a("1dde"),p=a("b622"),d=a("2d00"),g=p("isConcatSpreadable"),b=d>=51||!n((function(){var t=[];return t[g]=!1,t.concat()[0]!==t})),m=h("concat"),y=function(t){if(!s(t))return!1;var e=t[g];return void 0!==e?!!e:i(t)},w=!b||!m;r({target:"Array",proto:!0,arity:1,forced:w},{concat:function(t){var e,a,r,n,i,s=o(this),h=f(s,0),p=0;for(e=-1,r=arguments.length;e<r;e++)if(i=-1===e?s:arguments[e],y(i))for(n=l(i),c(p+n),a=0;a<n;a++,p++)a in i&&u(h,p,i[a]);else c(p+1),u(h,p++,i);return h.length=p,h}})},a9e3:function(t,e,a){"use strict";var r=a("83ab"),n=a("da84"),i=a("e330"),s=a("94ca"),o=a("cb2d"),l=a("1a2d"),c=a("7156"),u=a("3a9b"),f=a("d9b5"),h=a("c04e"),p=a("d039"),d=a("241c").f,g=a("06cf").f,b=a("9bf2").f,m=a("408a"),y=a("58a8").trim,w="Number",L=n[w],v=L.prototype,k=n.TypeError,_=i("".slice),S=i("".charCodeAt),D=function(t){var e=h(t,"number");return"bigint"==typeof e?e:A(e)},A=function(t){var e,a,r,n,i,s,o,l,c=h(t,"number");if(f(c))throw k("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=y(c),e=S(c,0),43===e||45===e){if(a=S(c,2),88===a||120===a)return NaN}else if(48===e){switch(S(c,1)){case 66:case 98:r=2,n=49;break;case 79:case 111:r=8,n=55;break;default:return+c}for(i=_(c,2),s=i.length,o=0;o<s;o++)if(l=S(i,o),l<48||l>n)return NaN;return parseInt(i,r)}return+c};if(s(w,!L(" 0o1")||!L("0b1")||L("+0x1"))){for(var I,E=function(t){var e=arguments.length<1?0:L(D(t)),a=this;return u(v,a)&&p((function(){m(a)}))?c(Object(e),a,E):e},x=r?d(L):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),N=0;x.length>N;N++)l(L,I=x[N])&&!l(E,I)&&b(E,I,g(L,I));E.prototype=v,v.constructor=E,o(n,w,E,{constructor:!0})}},bfd4:function(t,e,a){"use strict";a("dd6c")},c13f:function(t,e,a){},dd6c:function(t,e,a){},fa12:function(t,e,a){"use strict";var r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";e["a"]={createGuid:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:18,e="",a=0,n=r.length;while(a<t){var i=Math.round(Math.random()*n);i<0&&(i=0),i>=n&&(i=n-1),e+=r[i],a+=1}return e},isBlank:function(t){return null===t||void 0===t||""===t||"null"===t},createMapId:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:18,e="",a=0;a<t;a+=1){var n=Math.random()*r.length;n=Math.floor(n),e+=r.charAt(n)}return e}}}}]);